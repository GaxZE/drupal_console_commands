# Usage: drupal site:compile --placeholder="name:subscriptions"
command:
  name: site:compile
  description: 'Compiles the source, downloading and extracting the packages.'
commands:
# Run composer
  - command: site:compose
    arguments:
      name: '%{{name}}'
    options:
      destination-directory: '${{site_destination_directory}}'
# Run npm
  - command: exec
    arguments:
      bin: 'cd ${{site_destination_directory}}/web; find . -type d \( -name node_modules -o -name contrib -o -path ./core \) -prune -o -name package.json -execdir sh -c "npm install" \;'
# Run grunt
  - command: exec
    arguments:
      bin: 'cd ${{site_destination_directory}}/web; find . -type d \( -name node_modules -o -name contrib -o -path ./core \) -prune -o -name Gruntfile.js -execdir sh -c "grunt" \;'
